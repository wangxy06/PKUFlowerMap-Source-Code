#ifndef FLOWERDATA_H
#define FLOWERDATA_H

#include <QString>
#include <QStringList>
#include <QImage>
#include <QVector>
#include <QPointF>
#include <QMap>

struct FlowerInfo {
    int id;
    QString name;//花名
    QStringList florescence;//花期
    QStringList locationNames;//花所对应的地点
    QString introduction;//花的介绍

    FlowerInfo(int id = 0,
               const QString& name = QString(),
               const QStringList& florescence = QStringList(),
               const QStringList& locationNames = QStringList(),
               const QString& introduction = QString())
        : id(id), name(name), florescence(florescence),
        locationNames(locationNames), introduction(introduction)
    {}
};

class Flower
{
public:
    void loadFromExcel();

    // 数据查询
    const QVector<FlowerInfo>& getAllFlowers() const { return m_flowers; }
    const FlowerInfo* getFlowerById(int id) const;
    const FlowerInfo* getFlowerByName(const QString& name) const;
    QVector<const FlowerInfo*> getFlowersByLocation(const QString& location) const;
    QVector<const FlowerInfo*> getFlowersAtLocation(const QString& locationName) const;
    QVector<FlowerInfo> m_flowers;
    Flower(){
        m_flowers = {
            {1, "迎春花", {"3", "4", "5"}, {"勺海", "鸣鹤园"}, "花单生于叶腋间，花冠高脚杯状，鲜黄色，顶端通常6裂，或成复瓣。"},
            {2, "山桃", {"3", "4"}, {"未名湖"}, "花两性，2 朵并生，先叶开放，无柄，薯片平展，花瓣 5, 白色或浅红色；雄蕊多数，花药紫色。"},
            {3, "连翘", {"3", "4"}, {"未名湖"}, "花两性，先叶开放，花萼裂片 4， 长于花冠管，花冠黄色，裂片4；雄蕊2。"},
            {4, "蜡梅", {"2", "3"}, {"未名湖"}, "花两性，单生，先叶开放，花被片多数，无花萼与花瓣之分，均为花瓣状，蜡黄色；雄蕊多数。"},
            {5, "诸葛菜", {"4", "5", "6"}, {"未名湖"}, "花两性，紫色或褪为白色，花瓣开展，4枚，十字形；雄蕊6，4长2短。"},
            {6, "东京樱花", {"3", "4"}, {"塞万提斯像"}, "花两性，先叶开放，萼筒管状，外有短柔毛，萼片边缘有细齿，花瓣 5，顶端内凹，初时淡红色，后转白色。"},
            {7, "日本晚樱", {"3", "4"}, {"塞万提斯像"}, "花两性，先叶开放，萼筒管状，带紫红色，萼片边缘有细齿，花瓣为重瓣，初时粉红色，后转白色。"},
            {8, "郁李", {"4", "5"}, {"静园", "南阁"}, "花两性，先叶开放，1-3 朵簇生，萼片椭圆形，边缘有细锯齿，花瓣 5； 雄蕊多数。"},
            {9, "桃", {"4", "5"}, {"未名湖"}, "花两性，2 朵并生，先叶开放，无柄，萼片平展，花瓣 5， 通常粉红色，雄蕊多数，花药紫色。"},
            {10, "榆叶梅", {"3", "4"}, {"未名湖", "文史楼", "地学楼"}, "花两性，2 朵并生，先叶开放，有短柄；花瓣粉红色，5 枚或为重瓣；雄蕊 20。"},
            {11, "杏", {"4"}, {"俄文楼", "民主楼"}, "花两性，单生，先叶开放，萼片在花开后反折，花瓣 5，白色或浅红色；雄蕊多数，花药黄色。"},
            {12, "玉兰", {"4"}, {"图书馆"}, "花两性，单生小枝顶端，先叶开放，大而美丽；花被 9 片，萼片与花瓣无明显区别，全为白色或稍带紫红色。"},
            {13, "紫玉兰", {"4"}, {"红楼"}, "花单生小枝顶端，先叶开放或与叶同时开放；花被片 9, 明显分为 3 枚绿色的披针形萼片和6枚紫红色的披针形花瓣。"},
            {14, "紫丁香", {"4"}, {"图书馆"}, "花两性，极芳香，花冠紫色，高脚杯状，先端 4 裂，开展；雄蕊 2。"},
            {15, "皱皮木瓜", {"3", "4", "5"}, {"南阁", "西门"}, "花两性，先叶开放，花瓣 5, 猩红色；雄蕊多数。"},
            {16, "香茶藨子", {"5"}, {"南阁"}, "花两性，黄色，萼裂片反卷，花瓣 5，黄色，长为萼片一半。"},
            {17, "点地梅", {"4", "5"}, {"未名湖"}, "花葶通常数条，由基部叶腋抽出，伞形花序；花萼杯状，5 深裂几达基部，花冠通常白色，裂片 5, 喉部黄色。"},
            {18, "地黄", {"4", "5", "6"}, {"红楼"}, "花两性，略呈二唇形，花萼、花冠密被毛，花冠冠外面紫红色，内面黄色带紫斑。"},
            {19, "牡丹", {"5", "6"}, {"静园", "地学楼"}, "花单生枝顶，大而美丽，萼片 5, 绿色，花瓣 5 或常为重瓣，玫瑰色、红紫色、粉红色至白色；雄蕊多数。"},
            {20, "芍药", {"5", "6"}, {"静园"}, "花两性，数朵生枝顶或叶腋，萼片 4, 花瓣 9-13, 白色或粉红色；雄蕊多数。"},
            {21, "楸", {"4", "5"}, {"老生物楼", "邱德拔体育馆"}, "花两性，较梓为大，花冠白色，二唇形，内有紫色斑点。"},
            {22, "棣棠花", {"4", "5", "9", "10"}, {"未名湖"}, "花两性，单生于侧枝顶端，萼筒扁平，花瓣 5 或为重瓣，黄色；雄蕊多数。"},
            {23, "黄刺玫", {"5", "6", "7"}, {"未名湖"}, "花两性，单生，较小，萼筒光滑，花瓣 5, 黄色，倒卵形，重瓣或近重瓣，也有单瓣的；雄蕊多数。"},
            {24, "洋槐", {"5", "6"}, {"俄文楼"}, "花两性，蝶形，白色，具香气：雄蕊 10，2 体 (9 枚合生，1 枚离生)。"},
            {25, "紫荆", {"4", "5"}, {"一教"}, "花两性，于老干上簇生或成总状花序，先叶开放或与叶同时开放，两侧对称，花瓣 5, 紫色，上面 3 枚较小；雄蕊 10, 分离。"},
            {26, "大花野豌豆", {"4", "5"}, {"俄文楼"}, "总状花序腋生，比叶长；花两性，蝶形，蓝紫色。"},
            {27, "紫藤", {"4", "5"}, {"静园"}, "总状花序侧生，下垂，总花梗、小花梗及花萼密被柔毛；花两性，紫色或深紫色，雄蕊 10，2体。"},
            {28, "虞美人", {"5", "6", "7", "8"}, {"哲学楼"}, "花两性，单生，具长梗，花蕾时下垂，花瓣 4, 紫红色、红色至白色；雄蕊多数。"},
            {29, "鸢尾", {"5", "6"}, {"未名湖"}, "花冠蓝紫色或紫白色，外轮 3 枚花被片较大，圆形，下垂，内轮 3 枚花被片较小,倒卵形,中央有一行鸡冠状白色带紫纹的突起。"},
            {30, "黄花鸢尾", {"5", "6"}, {"未名湖"}, "花黄色，外轮花被片 3, 具紫褐色的条纹，两侧边缘有紫褐色耳状突起物，内轮花被片 3, 倒披针形，花盛开时向外倾斜。"},
            {31, "德国鸢尾", {"5", "6"}, {"未名湖"}, "花淡紫色、蓝紫色、深紫色或白色,有香味,外轮花被片3,反折,具条纹,中脉上密生黄色须领毛状附属物,内轮花被片3,上部向内拱曲。"},
            {32, "夏至草", {"3", "4", "5", "6"}, {"一教"}, "花两性，花萼钟形，具 5 齿，齿端有尖刺，花冠白色，二唇形，上唇较下唇长；雄蕊 4,2 长 2 短，不伸出。"},
            {33, "蛇莓", {"4", "5", "6", "7"}, {"蔡元培像"}, "花两性，单生叶腋，除 5 枚萼片外，还具 5 枚大于萼片的副萼，边缘 3 浅裂，花后反折，花瓣 5, 黄色，与萼片等长,雄蕊多数。"},
            {34, "毛洋槐", {"5"}, {"红楼"}, "花两性，蝶形，粉红或紫红色；雄蕊 10, 二体。"},
            {35, "欧洲荚蒾", {"5", "6"}, {"北阁"}, "花有二形，原亚种花序外围仅有一圈不育花，白色，花冠深 5 裂，中间为小形的可育花，花蕾绿白色，花药黄白色。"},
            {36, "互叶醉鱼草", {"5", "6"}, {"静园"}, "圆锥花序，簇生于二年生枝叶腋；花冠筒状，紫蓝色或紫红色，裂片 4；雄蕊 4, 无花丝。"},
            {37, "红丁香", {"5", "6"}, {"未名湖"}, "圆锥花序顶生：花两性，芳香，花冠淡紫红色、粉红色至白色，高脚杯状，花冠管细弱；雄蕊 2。"},
            {38, "锦带花", {"5", "6"}, {"东门", "蔡元培像"}, "花两性，花萼 5 裂，被毛，花冠漏斗状钟形，外面粉红色，里面灰白色：雄蕊 5。"},
            {39, "毛泡桐", {"5", "6"}, {"老生物楼"}, "花萼浅钟状，密被星状绒毛，5 裂至中部，花冠漏斗状钟形，外面淡紫色，有毛，内面白色，有紫色条纹。"},
            {40, "三裂绣线菊", {"5", "6"}, {"蔡元培像"}, "伞形花序；花小，两性，花瓣 5, 白色，先端微凹；雄蕊多数，比花瓣短。"},
            {41, "山楂", {"5", "6"}, {"校史馆"}, "复伞房花序，花序梗、花柄都有长柔毛：花两性，花瓣 5, 白色：雄蕊20。"},
            {42, "流苏树", {"6", "7"}, {"鸣鹤园", "塞万提斯像"}, "聚伞状圆锥花序着生侧枝枝顶；花冠白色，深 4 裂，裂片线状倒披针形；雄花具 2 雄蕊。"},
            {43, "大花糯米条", {"5", "6", "7"}, {"老生物楼"}, "花成簇着生于侧枝末端，单个花着生在 4 个叶状的花萼裂片中，花瓣白色，有时略带粉红色。"},
            {44, "蝟实", {"6"}, {"静园"}, "聚伞花序具 2 花，2 花的萼筒下部合生；萼筒有长柔毛，花冠钟状，粉红色至紫色。"},
            {45, "太平花", {"5", "6"}, {"图书馆"}, "总状花序，花两性，萼筒无毛，花瓣 4, 白色。"},
            {46, "荇菜", {"6", "7", "8"}, {"未名湖"}, "花两性，成束生于叶腋，黄色，花萼 5 深裂，花冠 5 深裂，喉部具毛：雄蕊 5。"},
            {47, "玫瑰", {"5", "6", "7"}, {"博雅塔"}, "花单生枝顶或 2-6 朵聚生，极香，萼片 5, 多扩大为叶状，花瓣 5, 或重瓣，花柱离生。"},
            {48, "暴马丁香", {"6"}, {"博雅塔"}, "圆锥花序大而稀疏，常侧生；花白色，较小，有浓郁气味，花萼、花冠均 4 裂，雄蕊2。"},
            {49, "萱草", {"6", "7"}, {"未名湖"}, "花大而美丽，漏斗形，花被下部合成花被简，上部具 6 裂片，长圆形，开展而反卷，边缘波状，橘红色。"},
            {50, "粉花绣线菊", {"6", "7"}, {"未名湖"}, "簇生呈复伞花序，花淡粉红色至深粉红色，稀白色，雄蕊较花瓣长。"},
            {51, "石榴", {"5", "6"}, {"燕南园"}, "花红色(栽培品种可为白色或黄色), 萼片硬，肉质，花瓣倒卵形，5-8 枚或重瓣；雄蕊多数。"},
            {52, "打碗花", {"7", "8", "9"}, {"镜春园"}, "花两性，单生叶腋，苞片大，2 枚，包于萼片之外，花冠漏斗状，粉红色，雄蕊5。"},
            {53, "黄荆", {"6", "7", "8"}, {"未名湖", "镜春园"}, "圆锥花序，花冠蓝紫色或偶为白色，二唇形，雄蕊 4,2 长 2 短，和花柱都稍外伸。"},
            {54, "枸杞", {"5", "6", "7", "8", "9"}, {"未名湖"}, "花两性，花萼通常 3 中裂或 4-5 齿裂，花冠漏斗状，淡紫色，5 深裂，雄蕊 5。"},
            {55, "栝楼", {"7", "8"}, {"博雅塔"}, "雄花成总状花序，雌花单生于叶腋，均为白色；花冠裂片 5, 边缘具流苏状细裂片。"},
            {56, "华北珍珠梅", {"7", "8", "9"}, {"未名湖"}, "顶生大型圆锥花序；花小，花瓣 5, 白色。"},
            {57, "莲", {"7", "8"}, {"荷花池"}, "花大，两性，粉红色或白色，花瓣多数，雄蕊多数。"},
            {58, "木槿", {"7", "8", "9"}, {"图书馆"}, "花两性，单生，具线形副萼，花瓣 5 或为重瓣，通常为红紫各色。"},
            {59, "忍冬", {"6", "7", "8"}, {"镜春园"}, "花两性，成对生于叶腋；花冠二唇形，外面具柔毛，上唇具 4 裂片，下唇反转，初开时白色，后变黄色，极芳香；雄蕊 5。"},
            {60, "紫薇", {"6", "7", "8", "9"}, {"图书馆", "勺海"}, "花大而美丽，花瓣 6, 粉红色、红色 (红薇) 或白色 (银薇), 边缘有不规则皱状缺刻，基部有长爪；雄蕊多数。"},
            {61, "泽芹", {"7", "8", "9"}, {"镜春园"}, "复伞形花序；花小，两性，花瓣 5, 白色。"},
            {62, "鸭跖草", {"6", "7", "8", "9", "10"}, {"朗润湖"}, "总状花序，佛焰苞有柄，心状卵形，边缘对合折叠。花两性，蓝色，花瓣3, 常 2 大 1 小；发育雄蕊 3。"},
            {63, "短尾铁线莲", {"7", "8"}, {"临湖轩"}, "花两性，直径 1.5-2 厘米，萼片 4，开展，白色，无花瓣。"},
            {64, "玉簪", {"6", "7", "8"}, {"一教"}, "总状花序顶生，高于叶丛；花白色，管状漏斗形，具浓香，在夜间开放，花被片 6。"},
            {65, "多花胡枝子", {"7", "8"}, {"鸣鹤园", "镜春园"}, "总状花序腋生；花两性，蝶形，粉红色至紫色。"},
            {66, "凤尾兰", {"6", "7", "8", "9", "10"}, {"一体", "老生物楼", "英杰交流中心"}, "圆锥花序，花大而下垂，花被片 6, 乳白色，常带红晕。"},
            {67, "海州常山", {"6", "7", "8", "9", "10", "11"}, {"老生物楼"}, "花两性，花萼蕾时绿白色，后变成紫红色，宿存，花冠白色或带粉红色；花丝和花柱同伸出花冠之外。"},
            {68, "山马兰", {"7", "8", "9"}, {"校史馆"}, "头状花序排成伞房状；总苞半球形，总苞片 3 层，上部绿色，无毛；舌状花淡蓝色，管状花黄色。"},
            {69, "甘菊", {"9", "10"}, {"未名湖"}, "头状花序单生于花梗上；舌状花和管状花均为黄色。"}
        };

    }
private:

};

class LocationManager
{
public:
    // 位置管理
    void addLocation(const QString& name, const QPointF& coord);
    QPointF getLocation(const QString& name) const;
    QStringList getAllLocationNames() const;
    bool loadLocationsFromFile(const QString& filePath);

private:
    QMap<QString, QPointF> m_locationMap;
};

/******************* 内联函数实现 *******************/
inline QVector<const FlowerInfo*> Flower::getFlowersAtLocation(const QString& locationName) const
{
    QVector<const FlowerInfo*> result;
    for (const auto& flower : m_flowers) {
        if (flower.locationNames.contains(locationName)) {
            result.append(&flower);
        }
    }
    return result;
}

inline const FlowerInfo* Flower::getFlowerById(int id) const
{
    for (const auto& flower : m_flowers) {
        if (flower.id == id) {
            return &flower;
        }
    }
    return nullptr;
}

inline const FlowerInfo* Flower::getFlowerByName(const QString& name) const
{
    for (const auto& flower : m_flowers) {
        if (flower.name == name) {
            return &flower;
        }
    }
    return nullptr;
}

#endif // FLOWERDATA_H
